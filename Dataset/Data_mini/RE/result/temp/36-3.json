[
    {
        "vulnerableLines": "1-5",
        "vulnerabilityReason": "The function uses send to transfer ether before updating the user's balance, which can allow reentrant calls.",
        "potentialSecurityRisk": "An attacker could exploit this to withdraw more funds than they have, draining the contract's balance through multiple calls before the state is updated.",
        "fixedCode": "function withdrawFunds_38(uint256 _weiToWithdraw) public { require(balances_38[msg.sender] >= _weiToWithdraw); balances_38[msg.sender] -= _weiToWithdraw; require(msg.sender.send(_weiToWithdraw)); }"
    },
    {
        "vulnerableLines": "56-60",
        "vulnerabilityReason": "The function allows an external call with send before updating the counter, leading to possible reentrant calls.",
        "potentialSecurityRisk": "An attacker could repeatedly call this function before reaching the counter limit, potentially exploiting it to drain ether.",
        "fixedCode": "function callcheck_7() public { require(counter_7 <= 5); counter_7 += 1; require(msg.sender.send(10 ether)); }"
    },
    {
        "vulnerableLines": "78-82",
        "vulnerabilityReason": "The function sends funds to lastPlayer_23 before updating, which allows a malicious contract to reenter and take more funds.",
        "potentialSecurityRisk": "An attacker could exploit this by calling this function repeatedly before their address is updated, allowing for multiple withdrawals.",
        "fixedCode": "function buyTicket_23() public { require(!(lastPlayer_23.send(jackpot_23))); lastPlayer_23 = msg.sender; jackpot_23 = address(this).balance; }"
    },
    {
        "vulnerableLines": "102-108",
        "vulnerabilityReason": "The function invokes send for ether transfer before incrementing the counter, risking reentrancy attacks.",
        "potentialSecurityRisk": "An attacker could call this function repeatedly, draining funds beyond the intended withdrawal limits.",
        "fixedCode": "function callcheck_14() public { require(counter_14 <= 5); counter_14 += 1; require(msg.sender.send(10 ether)); }"
    }
]