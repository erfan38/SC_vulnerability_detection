With the rapid expansion of using smart contracts, protecting the security of these contracts has become crucial. Existing analysis tools for detecting vulnerabilities in smart contracts are unreliable as they often fall short in accuracy, primarily due to their low recall rates—a significant challenge in this field. In this work, we utilize the open-source SolidiFi benchmark dataset to detect vulnerabilities related to Integer overflow/underflow (IoU), reentrancy (RE), and timestamp dependency (TD). These contracts, verified and available on Etherscan, proved unsuitable for direct application of LLMs due to comments, functions, and variables that might reveal the nature of the vulnerabilities. To address this, we performed several preprocessing steps to prepare the dataset for further research. We utilize a large language model to identify vulnerable code, provide reasoning for the vulnerabilities, explain how an attacker might exploit them, and propose fixed code. We design our prompts using chain-of-thought and expert patterns. Finally, we evaluate the results using various metrics and expert reviewers to assess the correctness of the reasoning, potential security risks, and code fixes. Our experiments demonstrate that our approach outperforms existing tools and methods. Notably, our recall rates are significantly high—93.5%, 95.4%, and 93.8%—addressing the challenge of low recall in detecting IoU, RE, and TD vulnerabilities, respectively.

SolidiFI Benchmark Repository: https://github.com/DependableSystemsLab/SolidiFI
Top 10 Vulnerabilities: We focus on three primary vulnerabilities from the DASP Top 10: RD, TD, and IoU. (https://dasp.co/)

In the src folder, you'll find the source code of our approach. The preprocessed SolidiFI dataset is organized in the Dataset folder under IoU, RE, and TD subfolders. The results for each type of vulnerability are stored within the corresponding subfolders.

If you use our code, dataset, or approach, please cite our work.

Citation details will be provided soon.
